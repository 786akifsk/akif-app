<!DOCTYPE html>
<html>
<head>
  <title>Redirecting...</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    window.onload = function () {
      // Get token from either fragment (#access_token=...) or query (?access_token=...)
      let token = null;

      const queryParams = new URLSearchParams(window.location.search);
      const hashParams = new URLSearchParams(window.location.hash.substring(1));

      if (queryParams.has("access_token")) {
        token = queryParams.get("access_token");
      } else if (hashParams.has("access_token")) {
        token = hashParams.get("access_token");
      }

      if (token) {
        const deepLink = `myapp://reset-password?access_token=${token}`;
        window.location.href = deepLink;

        // Optional fallback for debugging
        setTimeout(() => {
          document.body.innerHTML = "If you are not redirected, tap this: <a href='" + deepLink + "'>" + deepLink + "</a>";
        }, 2000);
      } else {
        document.body.innerText = "Missing token in URL.";
      }
    };
  </script>
</head>
<body>
  Redirecting to your app...
</body>
</html>
